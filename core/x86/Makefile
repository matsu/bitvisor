CONSTANTS-$(CONFIG_DEBUG_GDB) += -DDEBUG_GDB
CONSTANTS-$(CONFIG_TTY_SERIAL) += -DTTY_SERIAL
CONSTANTS-$(CONFIG_CPU_MMU_SPT_1) += -DCPU_MMU_SPT_1
CONSTANTS-$(CONFIG_CPU_MMU_SPT_2) += -DCPU_MMU_SPT_2
CONSTANTS-$(CONFIG_CPU_MMU_SPT_3) += -DCPU_MMU_SPT_3
CONSTANTS-$(CONFIG_CPU_MMU_SPT_USE_PAE) += -DCPU_MMU_SPT_USE_PAE
CONSTANTS-$(CONFIG_CPU_MMU_SPT_DISABLE) += -DCPU_MMU_SPT_DISABLE
CONSTANTS-$(CONFIG_PS2KBD_F11PANIC) += -DF11PANIC
CONSTANTS-$(CONFIG_PS2KBD_F12MSG) += -DF12MSG
CONSTANTS-$(CONFIG_STATUS) += -DSTATUS
CONSTANTS-$(CONFIG_PS2KBD_F10USB) += -DF10USBTEST
CONSTANTS-$(CONFIG_PS2KBD_F12USB) += -DF12DUMPEHCI
CONSTANTS-$(CONFIG_ENABLE_ASSERT) += -DENABLE_ASSERT
CONSTANTS-$(CONFIG_VTD_TRANS) += -DVTD_TRANS
CONSTANTS-$(CONFIG_DISABLE_TCG_BIOS) += -DDISABLE_TCG_BIOS
CONSTANTS-$(CONFIG_TCG_BIOS) += -DTCG_BIOS
CONSTANTS-$(CONFIG_BACKTRACE) += -DBACKTRACE
CONSTANTS-$(CONFIG_SHIFT_KEY_DEBUG) += -DSHIFT_KEY_DEBUG
CONSTANTS-$(CONFIG_DISABLE_VTD) += -DDISABLE_VTD
CONSTANTS-$(CONFIG_DMAR_PASS_THROUGH) += -DDMAR_PASS_THROUGH
CONSTANTS-$(CONFIG_USE_SYSCALL64) += -DUSE_SYSCALL64
CONSTANTS-$(CONFIG_DEBUG_SERIAL) += -DDEBUG_SERIAL

CFLAGS += -Icore/include
CFLAGS += $(CFLAGS_EDK2_INC)

objs-y += acpi.o
objs-y += acpi_dmar.o
objs-y += acpi_iohook.o
objs-y += ap.o
objs-y += arith.o
objs-y += asm.o
objs-y += beep.o
objs-y += cache.o
objs-y += callrealmode.o
objs-y += callrealmode_asm.o
objs-y += calluefi.o
objs-y += calluefi_asm.o
objs-y += cpu_emul.o
objs-y += cpu_interpreter.o
objs-y += cpu_mmu.o
objs-y += cpu_mmu_spt.o
objs-y += cpu_seg.o
objs-y += cpu_stack.o
objs-y += cpuid.o
objs-y += cpuid_pass.o
objs-y += current.o
objs-y += currentcpu.o
objs-y += debug.o
objs-y += entry.o
objs-y += exint.o
objs-y += exint_pass.o
objs-y += gmm.o
objs-y += gmm_access.o
objs-y += gmm_pass.o
objs-y += guest_bioshook.o
objs-y += i386-stub.o
objs-y += initipi.o
objs-y += initipi_pass.o
objs-y += int.o
objs-y += int_handler.o
objs-y += io_io.o
objs-y += io_iohook.o
objs-y += io_iopass.o
objs-y += keyboard.o
objs-y += loadbootsector.o
objs-y += localapic.o
objs-y += main.o
objs-y += mm.o
objs-y += mmio.o
objs-y += mmioclr.o
objs-y += msr.o
objs-y += msr_pass.o
objs-y += nmi.o
objs-y += nmi_handler.o
objs-y += nmi_pass.o
objs-y += osloader.o
objs-y += panic.o
objs-y += pcpu.o
objs-y += pmap.o
objs-y += process.o
objs-y += process_sysenter.o
objs-y += random.o
objs-y += reboot.o
objs-y += savemsr.o
objs-y += seg.o
objs-y += serial.o
objs-y += sleep.o
objs-y += string.o
objs-y += svm.o
objs-y += svm_exitcode.o
objs-y += svm_init.o
objs-y += svm_io.o
objs-y += svm_main.o
objs-y += svm_msr.o
objs-y += svm_np.o
objs-y += svm_paging.o
objs-y += svm_panic.o
objs-y += svm_regs.o
objs-y += sx_handler.o
objs-y += tcg.o
objs-y += thread.o
objs-y += thread_switch.o
objs-y += time.o
objs-y += tty.o
objs-y += uefi.o
objs-y += vcpu.o
objs-y += vmm_mem.o
objs-y += vmmcall.o
objs-y += vramwrite_pc.o
objs-y += vt.o
objs-y += vt_ept.o
objs-y += vt_exitreason.o
objs-y += vt_init.o
objs-y += vt_io.o
objs-y += vt_main.o
objs-y += vt_msr.o
objs-y += vt_paging.o
objs-y += vt_panic.o
objs-y += vt_regs.o
objs-y += vt_shadow_vt.o
objs-y += wakeup.o
objs-y += wakeup_entry.o
objs-y += xsetbv.o
objs-y += xsetbv_pass.o
